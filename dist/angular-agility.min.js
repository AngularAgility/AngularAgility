/*! angular-agility 20-03-2014 */
!function(){"use strict";function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})}function b(a){return a.replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})}function c(a){return a.replace(/([a-z](?=[A-Z]))/g,"$1 ")}function d(a){return a.outerHTML||function(a){var b,c=document.createElement("div");return c.appendChild(a.cloneNode(!0)),b=c.innerHTML,c=null,b}(a)}function e(a){var b=Array.prototype.slice.call(arguments,1);return a.replace(/{(\d+)}/g,function(a,c){return"undefined"!=typeof b[c]?b[c]:a})}function f(a,b){a.$aaFormExtensions[b]||(a.$aaFormExtensions[b]={hadFocus:!1,$errorMessages:[],$element:null})}function g(a,b,c){return{restrict:a?"EAC":"E",require:"form",compile:function(){return{pre:function(a,b,c,d){function e(a,b){a.$aaFormExtensions.$invalidAttempt=b,angular.forEach(a,function(c,d){0!==d.indexOf("$")&&a.constructor===c.constructor&&e(c,b)})}for(var f,g=b,h=null;;){if(g=g.parent(),f=g.data(),!f)break;if(f.$formController){h=f.$formController;break}}d.$aaFormExtensions={$onSubmitAttempt:function(){e(d,d.$invalid)},$parentForm:h,$allValidationErrors:[]},d.$parentForm&&a.$on("$destroy",function(){function a(c){c.$aaFormExtensions.$allValidationErrors.length&&(angular.forEach(b,function(a){for(var b,d=c.$aaFormExtensions.$allValidationErrors.length;d--;)b=c.$aaFormExtensions.$allValidationErrors[d],b.field.ngModel===a&&c.$aaFormExtensions.$allValidationErrors.splice(d,1)}),c.$aaFormExtensions.$parentForm&&a(c.$aaFormExtensions.$parentForm))}var b=[];angular.forEach(d,function(a,c){0!==c.indexOf("$")&&b.push(a)}),a(d.$parentForm)})},post:function(a,d,e,f){function g(){if(f.$aaFormExtensions.$invalidAttempt)return f.$aaFormExtensions.$allValidationErrors;var a=[];return angular.forEach(f.$aaFormExtensions.$allValidationErrors,function(b){b.field.hadFocus&&a.push(b)}),a}var h=null,i=a.$eval(e.notifyTarget),j=i||b.defaultNotifyTarget;j&&(null===f.$aaFormExtensions.$parentForm||i)&&a.$watch(function(){return angular.toJson([f.$aaFormExtensions.$allValidationErrors,f.$aaFormExtensions.$invalidAttempt])},function(){var a=f.$aaFormExtensions.$invalidAttempt&&f.$invalid;a||angular.forEach(f.$aaFormExtensions.$allValidationErrors,function(b){b.field.hadFocus&&(a=!0)}),h&&!a&&(c.remove(h,j),h=null),!h&&a&&(h=c.add({validationErrorsToDisplay:g},j,"aaFormExtensionsValidationErrors"))}),a.$on("$destroy",function(){h&&c.remove(h,j)})}}}}}angular.module("aa.formExtensions",["aa.notify"]).config(["aaNotifyConfigProvider","$httpProvider","$provide",function(a,b,c){a.addOrUpdateNotifyConfig("aaFormExtensionsValidationErrors",{template:'<div class="alert alert-danger aa-form-extensions-validation-errors"><strong>The following fields have validation errors: </strong><ul><li ng-repeat="error in notification.validationErrorsToDisplay()">{{ error.message }}&nbsp;<a href="" title="Show Field" ng-click="notification.showField(error)"><i class="fa fa-search"></i></a></li></ul></div>',options:{ttl:0,showField:function(a){a.field.$element[0].focus()}}}),c.factory("aaAjaxWatcher",["$rootScope",function(a){function b(){a.$$phase||a.$apply()}var c=0,d={isLoading:!1,increment:function(){c++,b()},decrement:function(){c--,b()}};return a.$watch(function(){return c},function(b){a.aaIsLoading=d.isLoading=b>0}),d}]),c.factory("aaAjaxInterceptor",["aaAjaxWatcher","$q",function(a,b){return{request:function(b){return a.increment(),b},response:function(b){return a.decrement(),b},responseError:function(c){return a.decrement(),b.reject(c)}}}]),b.interceptors.push("aaAjaxInterceptor")}]).directive("aaSaveForm",function(){return{link:function(){throw"aaSaveForm has been deprecated in favor of a more sensically named aaSubmitForm"}}}).directive("aaSubmitForm",["aaFormExtensions","$q",function(a,b){return{scope:{onInvalidAttempt:"&",aaSubmitForm:"&"},restrict:"A",require:"^form",link:function(c,d,e,f){d.on("click",function(){c.$apply(function(){if(f.$aaFormExtensions.$onSubmitAttempt(),f.$valid){var g=a.spinnerClickStrategies[e.spinnerClickStrategy||a.defaultSpinnerClickStrategy],h=g(d);h.before(),b.when(c.aaSubmitForm()).then(function(a){return h.after(),a})}else{var i="function"==typeof c.onInvalidAttempt(),j="function"==typeof a.defaultOnInvalidAttempt;if(i||j){var k=[];if(angular.forEach(f.$aaFormExtensions,function(a,b){0!==b.indexOf("$")&&(k=k.concat(a.$errorMessages))}),i)return void c.onInvalidAttempt(k,f);a.defaultOnInvalidAttempt(k,f)}}})})}}}]).directive("ngModel",["aaFormExtensions","$document",function(a,b){return{require:["ngModel","?^form"],priority:1,link:function(c,d,g,h){function i(){function b(a){h.push(a),a.$aaFormExtensions.$parentForm&&b(a.$aaFormExtensions.$parentForm)}var c,f=m.$errorMessages,h=[];f.length=0;for(var i in j.$error)j.$error[i]&&("minlength"===i?(c=e(g.ngMinlengthMsg||a.validationMessages.minlength,l,g.ngMinlength),f.push(c)):"maxlength"===i?(c=e(g.ngMaxlengthMsg||a.validationMessages.maxlength,l,g.ngMaxlength),f.push(c)):"min"===i?(c=e(g.minMsg||a.validationMessages.min,l,g.min),f.push(c)):"max"===i?(c=e(g.maxMsg||a.validationMessages.max,l,g.max),f.push(c)):"pattern"===i?(c=e(g.ngPatternMsg||a.validationMessages.pattern,l),f.push(c)):"required"===i&&"number"===d[0].type?(c=e(g.numberMsg||a.validationMessages.number,l),f.push(c)):a.validationMessages[i]&&(c=e(g[i+"Msg"]||a.validationMessages[i],l),f.push(c)));b(k),angular.forEach(h,function(a){for(var b=a.$aaFormExtensions.$allValidationErrors.length-1;b>=0;b--)a.$aaFormExtensions.$allValidationErrors[b].field===m&&a.$aaFormExtensions.$allValidationErrors.splice(b,1);angular.forEach(f,function(b){a.$aaFormExtensions.$allValidationErrors.push({field:m,message:b})})})}var j=h[0],k=h[1],l="This field";if(k){f(k,j.$name);var m=k.$aaFormExtensions[j.$name];g.aaLabel?l=g.aaLabel:d[0].id&&angular.forEach(b.find("label"),function(a){a.getAttribute("for")===d[0].id&&(l=(a.innerHTML||"").replace("*","").trim())}),m.$element=d,m.$ngModel=j,m.$form=k,d.on("blur",function(){m.hadFocus=!0,d.addClass("aa-had-focus"),c.$$phase||c.$apply()}),c.$watch(function(){return k.$aaFormExtensions.$invalidAttempt},function(a){a&&d.addClass("aa-invalid-attempt")}),c.$watch(function(){return j.$error},function(a){a&&i()},!0)}}}}]).directive("aaValMsg",["$compile","aaFormExtensions",function(a,b){return{require:["ngModel","^form"],link:function(c,d,e,f){var g=f[1];if(!e.name)throw"In order to use aaValMsg a name MUST be specified on the element: "+d[0];var h=b.valMsgPlacementStrategies[e.aaValMsg||b.defaultValMsgPlacementStrategy](d,g.$name,e.name);a(h)(c)}}}]).directive("aaValMsgFor",["aaFormExtensions",function(a){return{require:["^form"],priority:1,scope:!0,link:function(a,b,c){var d=c.aaValMsgFor,e=a.$eval(d),g=a.$eval(d.substring(0,d.indexOf(".")));f(g,e.$name);var h=a.$eval(d.replace(".",".$aaFormExtensions."));a.$watchCollection(function(){return h.$errorMessages},function(b){a.errorMessages=b}),a.$watchCollection(function(){return[g.$aaFormExtensions.$invalidAttempt,h.hadFocus]},function(b){var c=b[0],d=b[1];a.showMessages=c||d})},template:a.valMsgForTemplate,replace:!0}}]).directive("aaLabel",["aaFormExtensions",function(b){return{compile:function(c,d){if("SELECT"===c.prop("tagName").toUpperCase()&&void 0!==d.defaultOption){var e=d.defaultOption;(null===e||""===e)&&(e="Select",d.aaLabel&&(e+=" a "+d.aaLabel),e+="..."),c.append(angular.element('<option value=""></option>').html(e))}return function(c,d,e){var f=b.labelStrategies[e.aaLabelStrategy];if(!f){var g=c.$eval(e.aaLabelStrategy);angular.isFunction(g)&&(f=g)}f||(f=b.labelStrategies[b.defaultLabelStrategy]);var h=void 0!==e.required;d[0].id||(d[0].id=a()),f(d,e.aaLabel,h)}}}}]).directive("aaAutoField",function(){return{link:function(){throw"aaAutoField has been deprecated in favor aaField"}}}).directive("aaField",["$compile",function(a){return{restrict:"A",scope:!1,replace:!0,priority:1e3,terminal:!0,compile:function(e,f){e.attr("ng-model",f.aaField);var g=f.aaField.substring(f.aaField.lastIndexOf(".")+1);return f.name||e.attr("name",g),f.type||"INPUT"!==e.prop("tagName").toUpperCase()||e.prop("type","text"),f.aaLabel||void 0!==f.noLabel||(g.lastIndexOf("Id")===g.length-2&&(g=g.substring(0,g.length-2)),e.attr("aa-label",b(c(g)))),e.attr("aa-val-msg",""),e.removeAttr("aa-field"),e.replaceWith(d(e[0])),function(b,c){a(c)(b)}}}}]).directive("aaAutoFieldGroup",function(){return{link:function(){throw"aaAutoFieldGroup has been deprecated in favor aaFieldGroup"}}}).directive("aaFieldGroup",["$compile","aaFormExtensions",function(a,b){return{restrict:"A",scope:!1,replace:!0,priority:1100,terminal:!0,compile:function(c,d){c.removeAttr("aa-field-group"),c.attr("aa-field",d.aaFieldGroup);var e=b.fieldGroupStrategies[d.fieldGroupStrategy||b.defaultFieldGroupStrategy];return e(c),function(b,c){a(c)(b)}}}}]).directive("aaValidIcon",["aaFormExtensions",function(a){return{require:"ngModel",scope:!1,compile:function(b){var c=a.validIconStrategy.getContainer(b),d=angular.element(a.validIconStrategy.validIcon);c.append(d),d[0].style.display="none";var e=angular.element(a.validIconStrategy.invalidIcon);return c.append(e),e[0].style.display="none",function(a,b,c,f){f.$parsers.push(function(a){return f.$valid?(d[0].style.display="",e[0].style.display="none"):(d[0].style.display="none",e[0].style.display=""),a})}}}}]).directive("aaSpinnerClick",["$q","aaFormExtensions",function(a,b){return{link:function(c,d,e){var f=b.spinnerClickStrategies[e.spinnerClickStrategy||b.defaultSpinnerClickStrategy];if(!f)throw"An inline or default spinner click strategy must be specified";d.on("click",function(){c.$apply(function(){var b=f(d);b.before(),a.when(c.$eval(e.aaSpinnerClick)).then(function(a){return b.after(),a})})})}}}]).directive("ngForm",["aaFormExtensions","aaNotify",function(a,b){return g(!0,a,b)}]).directive("form",["aaFormExtensions","aaNotify",function(a,b){return g(!1,a,b)}]).provider("aaFormExtensions",function(){var a=this;this.defaultLabelStrategy="default",this.setDefaultLabelStrategy=function(a){this.defaultLabelStrategy=a},this.labelStrategies={bootstrap3InlineForm:function(a,b,c){var d=angular.element("<label>").attr("for",a[0].id).addClass("col-sm-2 control-label").html(b+(c?" *":"")),e=["button","submit"];if(-1!==e.indexOf(a[0].type))throw"Generating a label for and input type "+a[0].type+" is unsupported.";a.parent().parent().prepend(d)},"default":function(a,b,c){a[0].parentNode.insertBefore(angular.element("<label>").attr("for",a[0].id).html(b+(c?" *":""))[0],a[0])}},this.registerLabelStrategy=function(a,b){this.labelStrategies[a]=b},this.defaultFieldGroupStrategy="bootstrap3InlineForm",this.setDefaultFieldGroupStrategy=function(a){this.defaultFieldGroupStrategy=a},this.fieldGroupStrategies={bootstrap3InlineForm:function(a){a.prop("class")||a.addClass("form-control"),a.wrap('<div class="form-group"><div class="col-sm-3"></div></div>')}},this.registerFieldGroupStrategy=function(a,b){this.fieldGroupStrategies[a]=b},this.defaultValMsgPlacementStrategy="default",this.setDefaultValMsgPlacementStrategy=function(a){this.defaultValMsgPlacementStrategy=a},this.valMsgPlacementStrategies={"default":function(a,b,c){var d=angular.element(e('<div aa-val-msg-for="{0}.{1}"></div>',b,c)),f=a[0].type;return f=f?f.toLowerCase():"text","radio"===f?a.parent().parent().append(d):a.after(d),d}},this.registerValMsgPlacementStrategy=function(a,b){this.valMsgPlacementStrategies[a]=b},this.validIconStrategy={validIcon:'<i class="fa fa-check fa-lg"></i>',invalidIcon:'<i class="fa fa-exclamation-circle fa-lg"></i>',getContainer:function(a){var b=angular.element('<div class="col-xs-1 validation-icons"></span>');return a.parent().after(b),b}},this.setValidIconStrategy=function(b){a.validIconStrategy=b},this.defaultSpinnerClickStrategy="fontAwesomeInsideButton",this.setDefaultSpinnerClickStrategy=function(a){this.defaultSpinnerClickStrategy=a},this.spinnerClickStrategies={fontAwesomeInsideButton:function(a){var b=angular.element('<i style="margin-left: 5px;" class="fa fa-spinner fa-spin"></i>');return{before:function(){a.prop("disabled",!0),a.append(b)},after:function(){a.prop("disabled",!1),b.remove()}}}},this.registerSpinnerClickStrategy=function(a,b){this.spinnerClickStrategies[a]=b},this.defaultNotifyTarget="default",this.setDefaultNotifyTarget=function(a){this.defaultNotifyTarget=a},this.validationMessages={required:"{0} is required.",email:"The field {0} must be an email.",minlength:"{0} must be at least {1} character(s).",maxlength:"{0} must be less than {1} characters.",min:"{0} must be at least {1}.",max:"{0} must be at most {1}.",pattern:"{0} is invalid.",url:"{0} must be a valid URL.",number:"{0} must be number."},this.setValidationMessage=function(b,c){a.validationMessages[b]=c},this.setValidationMessages=function(b){a.validationMessages=b},this.valMsgForTemplate='<div class="validation-error" ng-show="showMessages" ng-repeat="msg in errorMessages">{{msg}}</div>',this.setValMsgForTemplate=function(a){this.valMsgForTemplate=a},this.defaultOnInvalidAttempt=function(){},this.setDefaultOnInvalidAttempt=function(a){this.defaultOnInvalidAttempt=a},this.$get=function(){return{defaultLabelStrategy:a.defaultLabelStrategy,labelStrategies:a.labelStrategies,defaultFieldGroupStrategy:a.defaultFieldGroupStrategy,fieldGroupStrategies:a.fieldGroupStrategies,validIconStrategy:a.validIconStrategy,validationMessages:a.validationMessages,valMsgForTemplate:a.valMsgForTemplate,valMsgPlacementStrategies:a.valMsgPlacementStrategies,defaultValMsgPlacementStrategy:a.defaultValMsgPlacementStrategy,defaultOnInvalidAttempt:a.defaultOnInvalidAttempt,defaultSpinnerClickStrategy:a.defaultSpinnerClickStrategy,spinnerClickStrategies:a.spinnerClickStrategies,defaultNotifyTarget:a.defaultNotifyTarget}}})}(),function(){"use strict";angular.module("aa.notify",[]).factory("aaNotify",["aaNotifyConfig","$rootScope","$sce",function(a,b,c){return{success:function(a,b){return this.add(angular.extend({message:a,messageType:"success"},b))},info:function(a,b){return this.add(angular.extend({message:a,messageType:"info"},b))},warning:function(a,b){return this.add(angular.extend({message:a,messageType:"warning"},b))},danger:function(a,b){return this.add(angular.extend({message:a,messageType:"danger"},b))},error:function(a,b){return this.add(angular.extend({message:a,messageType:"error"},b))},add:function(d,e,f){return f=f||a.notifyConfigs[a.defaultNotifyConfig],angular.isString(f)&&(f=a.notifyConfigs[f]),e=e||f.defaultTargetContainerName,d=angular.extend(angular.copy(f.options),d),d.messageHandle={},f.optionsTransformer&&f.optionsTransformer(d,c),d.template=f.templateUrl||f.templateName,b.$broadcast("aaNotifyContainer-"+e+"-add",d),d.messageHandle},remove:function(c,d){d=d||a.notifyConfigs[a.defaultNotifyConfig].defaultTargetContainerName,b.$broadcast("aaNotifyContainer-"+d+"-remove",c)}}}]).directive("aaNotify",["$timeout",function(a){return{template:'<div><div ng-repeat="notification in notifications"><div ng-include="notification.template"></div></div></div>',replace:!0,link:function(b,c,d){b.notifications=[];var e=d.containerName||"default";b.$on("aaNotifyContainer-"+e+"-add",function(c,d){b.notifications.push(d),d.ttl>0&&a(function(){b.notifications.splice(b.notifications.indexOf(d),1)},d.ttl)}),b.$on("aaNotifyContainer-"+e+"-remove",function(a,c){for(var d=b.notifications.length-1;d>=0;d--)if(b.notifications[d].messageHandle===c){b.notifications.splice(d,1);break}}),b.close=function(a){b.notifications.splice(b.notifications.indexOf(a),1)}}}}]).provider("aaNotifyConfig",function(){var a=this;a.notifyConfigs={},a.addOrUpdateNotifyConfig=function(b,c){var d=a.notifyConfigs[b]=a.notifyConfigs[b]||{};d.name=b,angular.extend(d,c),d.template&&(d.templateName="aaNotifyTemplate-"+d.name)},a.addOrUpdateNotifyConfig("default",{template:'<div class="alert aa-notify-notification" ng-class="notification.cssClasses"><div class="pull-right aa-notify-close" ng-if="notification.showClose" ng-click="close(notification)">&nbsp;<i class="fa fa-times"></i></div><i class="aa-notify-icon" ng-if="notification.iconClass" ng-class="notification.iconClass"></i>&nbsp;<span ng-if="!notification.allowHtml" class="aa-notify-message">{{notification.message}}</span><span ng-if="notification.allowHtml" class="aa-notify-message" ng-bind-html="notification.message"></span></div>',options:{ttl:4e3},defaultTargetContainerName:"default",optionsTransformer:function(a,b){a.cssClasses||(a.cssClasses=""),"success"===a.messageType?a.cssClasses+="alert-success":"info"===a.messageType?a.cssClasses+="alert-info":"warning"===a.messageType?a.cssClasses+="alert-warning":("danger"===a.messageType||"error"===a.messageType)&&(a.cssClasses+="alert-danger alert-error"),a.allowHtml&&(a.message=b.trustAsHtml(a.message))}}),a.setDefaultNotifyConfig=function(b){a.defaultNotifyConfig=b},a.defaultNotifyConfig="default",this.$get=function(){return{notifyConfigs:a.notifyConfigs,defaultNotifyConfig:a.defaultNotifyConfig}}}).run(["aaNotifyConfig","$templateCache",function(a,b){angular.forEach(a.notifyConfigs,function(a){a.templateName&&b.put(a.templateName,a.template)})}])}(),angular.module("aa.select2",[]).directive("aaSelect2",function(a){return{require:"ngModel",template:'<input type="text" />',replace:!0,link:function(b,c,d,e){function f(a){return Object.keys?0===Object.keys(a).length:"{}"===JSON.stringify(a)}var g=b.$eval(d.aaSelect2);if(!angular.isObject(g)||f(g))throw'aa-select2 options must be specified. Ex: <div aa-select2="*options here*"...\r\n';var h={},i=g?angular.isFunction(g.options):!1,j=g?angular.isArray(g.options):!1,k=g&&g.mode?-1!==g.mode.indexOf("id"):!1,l=g&&g.mode?-1!==g.mode.indexOf("object"):!1,m=g&&g.mode?-1!==g.mode.indexOf("tags"):!1,n=g&&"@this"===g.id&&"@this"===g.text;if(g.select2&&g.select2.allowClear&&(h.placeholder="Select..."),d.placeholder&&(h.placeholder=d.placeholder),g){if(n?(g.id="id",g.text="text"):(g.id=g.id||"id",g.text=g.text||"text"),j)if(h.data=h.data||{},h.data.text=g.text,n){var o=[];angular.forEach(g.options,function(a){o.push({id:a,text:a})}),h.data.results=o}else h.data.results=g.options;i&&(h.query=function(a){g.options(a.term).success(function(b){if(n){var c=[];angular.forEach(b,function(a){c.push({id:a,text:a})}),b=c}a.callback({results:b,text:g.text})})},k&&(h.initSelection=function(b,c){return e.$modelValue?n?void c({id:e.$modelValue,text:e.$modelValue}):void a.when(g.textLookup(e.$modelValue)).then(function(a){var b;if(b=angular.isUndefined(a.data)?a:a.data,!angular.isObject(b)){var d={};d[g.id]=e.$modelValue,d[g.text]=b,b=d}c(b)}):void 0})),h.id=g.id,h.formatSelection=function(a){return a[g.text]},h.formatResult=function(a){return a[g.text]},m&&(h.tags=e.$modelValue||[])}var p={width:"resolve"},q=angular.extend(p,h,g.select2);c.select2(q),e.$render=function(){return e.$modelValue?void(k?c.select2("val",e.$modelValue):l&&c.select2("data",e.$modelValue)):void c.select2("val","")},c.bind("change",function(){b.$apply(function(){var a=c.select2("data"),b=null;a?l?b=a:k&&(angular.isArray(a)?(b=[],angular.forEach(a,function(a){b.push(a[g.id])})):b=a[g.id]):b=null,e.$setViewValue(b)})}),c.bind("$destroy",function(){c.select2("destroy")})}}});