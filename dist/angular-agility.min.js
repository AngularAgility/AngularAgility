/*
angular-agility "version":"0.8.23" @ 2015-03-12T10:29:01
Copyright (c) 2014 - John Culviner
Licensed under the MIT license
*/

!function(){"use strict";angular.module("aa.notify",[]).factory("aaNotify",["aaNotifyConfig","$rootScope","$sce",function(a,b,c){return{success:function(b,c){return a.notifyConfigs[a.defaultNotifyConfig].namedDefaults.success(b,c,this)},info:function(b,c){return a.notifyConfigs[a.defaultNotifyConfig].namedDefaults.info(b,c,this)},warning:function(b,c){return a.notifyConfigs[a.defaultNotifyConfig].namedDefaults.warning(b,c,this)},danger:function(b,c){return a.notifyConfigs[a.defaultNotifyConfig].namedDefaults.danger(b,c,this)},error:function(b,c){return a.notifyConfigs[a.defaultNotifyConfig].namedDefaults.error(b,c,this)},add:function(d,e,f){return f=f||a.notifyConfigs[a.defaultNotifyConfig],angular.isString(f)&&(f=a.notifyConfigs[f]),e=e||f.defaultTargetContainerName,d=angular.extend(angular.copy(f.options),d),d.messageHandle={},f.optionsTransformer&&f.optionsTransformer(d,c),d.template=f.templateUrl||f.templateName,b.$broadcast("aaNotifyContainer-"+e+"-add",d),d.messageHandle},remove:function(c,d){d=d||a.notifyConfigs[a.defaultNotifyConfig].defaultTargetContainerName,b.$broadcast("aaNotifyContainer-"+d+"-remove",c)},clearAll:function(c){c=c||a.notifyConfigs[a.defaultNotifyConfig].defaultTargetContainerName,b.$broadcast("aaNotifyContainer-"+c+"-clearAll")}}}]).directive("aaNotify",["$timeout",function(a){return{template:'<div><div ng-repeat="notification in notifications" class="aa-notification"><div ng-include="notification.template"></div></div></div>',replace:!0,link:function(b,c,d){b.notifications=[];var e=d.containerName||"default";b.$on("aaNotifyContainer-"+e+"-add",function(c,d){d.replaceExisting&&(b.notifications.length=0),b.notifications.push(d),d.ttl>0&&a(function(){var a=b.notifications.indexOf(d);a>-1&&b.notifications.splice(a,1)},d.ttl)}),b.$on("aaNotifyContainer-"+e+"-remove",function(a,c){for(var d=b.notifications.length-1;d>=0;d--)if(b.notifications[d].messageHandle===c){b.notifications.splice(d,1);break}}),b.$on("aaNotifyContainer-"+e+"-clearAll",function(){b.notifications.length=0}),b.close=function(a){b.notifications.splice(b.notifications.indexOf(a),1),angular.isFunction(a.onClose)&&a.onClose()}}}}]).provider("aaNotifyConfig",function(){var a=this;a.notifyConfigs={},a.addOrUpdateNotifyConfig=function(b,c){var d=a.notifyConfigs[b]=a.notifyConfigs[b]||{};d.name=b,angular.extend(d,c),d.template&&(d.templateName="aaNotifyTemplate-"+d.name)},a.addOrUpdateNotifyConfig("default",{template:'<div class="alert aa-notify-notification" ng-class="notification.cssClasses"><div class="pull-right aa-notify-close" ng-if="notification.showClose" ng-click="close(notification)"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-times fa-stack-1x fa-inverse"></i></span></div><i class="aa-notify-icon" ng-if="notification.iconClass" ng-class="notification.iconClass"></i>&nbsp;<span ng-if="!notification.allowHtml" class="aa-notify-message">{{notification.message}}</span><span ng-if="notification.allowHtml" class="aa-notify-message" ng-bind-html="notification.message"></span></div>',options:{ttl:4e3,replaceExisting:!1},namedDefaults:{success:function(a,b,c){return c.add(angular.extend({message:a,messageType:"success"},b))},info:function(a,b,c){return c.add(angular.extend({message:a,messageType:"info"},b))},warning:function(a,b,c){return c.add(angular.extend({message:a,messageType:"warning"},b))},danger:function(a,b,c){return c.add(angular.extend({message:a,messageType:"danger"},b))},error:function(a,b,c){return c.add(angular.extend({message:a,messageType:"error"},b))}},defaultTargetContainerName:"default",optionsTransformer:function(a,b){a.cssClasses||(a.cssClasses=""),"success"===a.messageType?a.cssClasses+="alert-success":"info"===a.messageType?a.cssClasses+="alert-info":"warning"===a.messageType?a.cssClasses+="alert-warning":("danger"===a.messageType||"error"===a.messageType)&&(a.cssClasses+="alert-danger alert-error"),a.allowHtml&&(a.message=b.trustAsHtml(a.message))}}),a.defaultNotifyConfig="default",this.$get=function(){return{notifyConfigs:a.notifyConfigs,defaultNotifyConfig:a.defaultNotifyConfig}}}).run(["aaNotifyConfig","$templateCache",function(a,b){angular.forEach(a.notifyConfigs,function(a){a.templateName&&b.put(a.templateName,a.template)})}])}(),angular.module("aa.select2",[]).directive("aaSelect2",["$q",function(a){"use strict";return{require:"ngModel",template:'<input type="text" />',replace:!0,link:function(b,c,d,e){function f(a){return Object.keys?0===Object.keys(a).length:"{}"===JSON.stringify(a)}var g=angular.copy(b.$eval(d.aaSelect2));if(!angular.isObject(g)||f(g))throw'aa-select2 options must be specified. Ex: <div aa-select2="*options here*"...\r\n';var h={},i=g?angular.isFunction(g.options):!1,j=g?angular.isArray(g.options):!1,k=g&&g.mode?-1!==g.mode.indexOf("id"):!1,l=g&&g.mode?-1!==g.mode.indexOf("object"):!1,m=g&&g.mode?-1!==g.mode.indexOf("tags"):!1,n=g&&"@this"===g.id&&"@this"===g.text;if(g.select2&&g.select2.allowClear&&(h.placeholder="Select..."),d.placeholder&&(h.placeholder=d.placeholder),g){if(n?(g.id="id",g.text="text"):(g.id=g.id||"id",g.text=g.text||"text"),j)if(h.data=h.data||{},h.data.text=g.text,n){var o=[];angular.forEach(g.options,function(a){o.push({id:a,text:a})}),h.data.results=o}else h.data.results=g.options;i&&(h.query=function(a){g.options(a.term).success(function(b){if(n){var c=[];angular.forEach(b,function(a){c.push({id:a,text:a})}),b=c}a.callback({results:b,text:g.text})})},k&&(h.initSelection=function(b,c){if(e.$modelValue){if(n&&m){var d=[];return angular.forEach(e.$modelValue,function(a){d.push({id:a,text:a})}),void c(d)}if(n)return void c({id:e.$modelValue,text:e.$modelValue});var f=angular.isArray(e.$modelValue),h=[];f?angular.forEach(e.$modelValue,function(a){h.push(g.textLookup(a))}):h.push(g.textLookup(e.$modelValue)),a.all(h).then(function(a){function b(a){var b;if(b=angular.isUndefined(a.data)?a:a.data,!angular.isObject(b)){var c={};c[g.id]=e.$modelValue,c[g.text]=b,b=c}return b}if(f){var d=[];angular.forEach(a,function(a){d.push(b(a))}),c(d)}else c(b(a[0]))})}})),h.id=g.id,h.formatSelection=function(a){return a[g.text]},h.formatResult=function(a){return a[g.text]},m&&(h.tags=e.$modelValue||[])}var p={width:"resolve"},q=angular.extend(p,h,g.select2);c.select2(q),e.$render=function(){return e.$modelValue?void(k?c.select2("val",e.$modelValue):l&&c.select2("data",e.$modelValue)):void c.select2("val","")},c.bind("change",function(){b.$apply(function(){var a=c.select2("data"),b=null;a?l?b=a:k&&(angular.isArray(a)?(b=[],angular.forEach(a,function(a){b.push(a[g.id])})):b=a[g.id]):b=null,e.$setViewValue(b)})}),c.bind("$destroy",function(){c.select2("destroy")})}}}]),function(){"use strict";angular.module("aa.formExternalConfiguration",[]).directive("aaConfiguredForm",["$compile","$parse",function(a,b){return{mergedAttrs:[],restrict:"A",scope:!1,replace:!0,priority:500,terminal:!0,compile:function(){var c=this;return function(d,e,f){var g=b(f.validationConfig)(d);e.removeAttr("validation-config"),e.removeAttr("aa-configured-form"),g&&(g.ignore=g.ignore||{},c.findFormElements(e.children(),g)),a(e)(d)}},findFormElements:function(a,b){var c=this;angular.forEach(a,function(a){var d=angular.element(a),e=d.attr("ng-model")||d.attr("data-ng-model")||d.attr("ngModel")||d.attr("aa-field")||d.attr("aa-field-group")||d.attr("data-aa-field")||d.attr("data-aa-field-group");if(e){if(b.ignore[d[0].name])return;c.processElement(d,e,b)}c.findFormElements(d.children(),b)})},processElement:function(a,b,c){a.attr("name")||a.attr("name",b.substring(b.lastIndexOf(".")+1)),this.addValidations(a,b,c)},addValidations:function(a,b,c){var d;if(!(b.indexOf(".")>-1))throw new Error("the name attribute value needs to contain a '.' char");d=b.split(".");var e=d[d.length-2],f=d[d.length-1];e=this.resolveModelName(e,b,c);var g=c.validations[e];g?(this.checkIfAlreadyMerged(e+"."+f)||g[f]&&g[f]["aa-inherit"]&&this.mergeInheritedAttributes(g[f],g[f]["aa-inherit"],g,c.validations),this.addAttributes(a,g[f])):console.log("nopes");var h=c.globals;h&&this.addAttributes(a,h,g,c)},checkIfAlreadyMerged:function(a){return this.mergedAttrs.indexOf(a)<0?(this.mergedAttrs.push(a),!1):!0},addAttributes:function(a,b){for(var c in b)"aa-inherit"!==c&&("required"!==c?a.attr(c,b[c]):a.prop(c,b[c]))},mergeInheritedAttributes:function(a,b,c,d){var e=this.getInheritedAttributes(b,c,d);e["aa-inherit"]&&!this.checkIfAlreadyMerged(e["aa-inherit"])&&this.mergeInheritedAttributes(e,e["aa-inherit"],c,d);for(var f in e)a.hasOwnProperty(f)||"aa-inherit"!==f&&(a[f]=e[f])},getInheritedAttributes:function(a,b,c){if(a.indexOf(".")<0)return b[a];var d=a.split(".");return c[d[0]][d[1]]},resolveModelName:function(a,b,c){return c.resolveFn?c.resolveFn(b):c.resolve&&c.resolve[a]?c.resolve[a]:a}}}])}(),function(){"use strict";angular.module("aa.formExtensions",["aa.notify"]).config(["aaNotifyConfigProvider","$httpProvider","$provide",function(a,b,c){a.addOrUpdateNotifyConfig("aaFormExtensionsValidationErrors",{template:'<div class="alert alert-danger aa-form-extensions-validation-errors"><div class="pull-right aa-notify-close" ng-click="close(notification)"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-times fa-stack-1x fa-inverse"></i></span></div><strong>There are some validation errors: </strong><ul><li ng-repeat="error in notification.validationErrorsToDisplay()">{{ error.message }}&nbsp;<a href="" title="Focus Field" ng-show="error.field" ng-click="notification.showField(error)"><i class="fa fa-search"></i></a></li></ul></div>',options:{ttl:0,showField:function(a){a.field.$element[0].focus()}}}),c.factory("aaLoadingWatcher",["$rootScope",function(a){function b(){a.aaIsLoading=d.isLoading=c>0,a.$$phase||a.$apply()}var c=0,d={isLoading:!1,increment:function(){c++,b()},decrement:function(){c--,b()}};return d}]),c.factory("aaAjaxInterceptor",["aaLoadingWatcher","$q","aaFormExtensions",function(a,b,c){return{request:function(b){return a.increment(),b},response:function(b){return a.decrement(),b},responseError:function(d){return a.decrement(),c.ajaxValidationErrorMappingStrategy&&c.ajaxValidationErrorMappingStrategy(d,c.availableForms),b.reject(d)}}}]),b.interceptors.push("aaAjaxInterceptor"),c.decorator("$controller",["$delegate",function(a){return function(b,c){function d(a){c.$scope.$$aaFormExtensionsTodos||(c.$scope.$$aaFormExtensionsTodos=[]),c.$scope.$$aaFormExtensionsTodos.push(a)}return!c.$aaFormExtensions&&c.$scope&&(c.$aaFormExtensions={$addChangeDependency:function(a,b,c){d({type:"$addChangeDependency",args:[a,b],targetFormName:c})},$resetChanged:function(a,b){d({type:"$resetChanged",args:[a],targetFormName:b})},$reset:function(a,b){d({type:"$reset",args:[a],targetFormName:b})},$clearErrors:function(a,b){d({type:"$clearErrors",args:[a],targetFormName:b})},$addValidationError:function(a,b,c){d({type:"$addValidationError",args:[a,b],targetFormName:c})}}),a.apply(this,arguments)}}])}])}(),function(){"use strict";function a(b,c){var d;if(d=b.attr(c))return d;var e=b.parent();return e.length?(d=e.attr(c),d?d:a(e,c)):void 0}function b(a,b){var c=document.createElement("div");c.innerHTML=b,a.length||(a=[a]);for(var d=a.length-1;d>=0;d--){for(var e=a[d],f=c.firstChild.cloneNode(!0),g=f;g.firstChild;)g=g.firstChild;var h=e.parentNode,i=e.nextSibling;g.appendChild(e),i?h.insertBefore(f,i):h.appendChild(f)}}function c(a){var b=Array.prototype.slice.call(arguments,1);return a.replace(/{(\d+)}/g,function(a,c){return"undefined"!=typeof b[c]?b[c]:a})}angular.module("aa.formExtensions").provider("aaFormExtensions",function(){var d=this;this.requiredLabelClass="label-required",this.defaultLblCol="sm-2",this.defaultLabelStrategy="bootstrap3InlineForm",this.labelStrategies={bootstrap3InlineForm:function(b,c,e){var f=a(b,"aa-lbl-col")||d.defaultLblCol,g=a(b,"aa-lbl-class")||"",h=angular.element("<label>").attr("for",b[0].id).addClass("col-"+f+" control-label "+g).addClass(e?d.requiredLabelClass:"").html(c+(e?"&nbsp;*":"")),i=["button","submit"];if(-1!==i.indexOf(b[0].type))throw new Error("Generating a label for and input type "+b[0].type+" is unsupported.");b.parent().parent().prepend(h)},simple:function(a,b,c){a[0].parentNode.insertBefore(angular.element("<label>").attr("for",a[0].id).addClass(c?d.requiredLabelClass:"").html(b+(c?"&nbsp;*":""))[0],a[0])}},this.defaultCol="sm-3",this.defaultFieldGroupStrategy="bootstrap3InlineForm",this.fieldGroupStrategies={bootstrap3InlineForm:function(c){c.prop("class")||c.addClass("form-control");var e=a(c,"aa-col")||d.defaultCol;b(c,'<div class="form-group"><div class="col-'+e+'"></div></div>')},bootstrap3BasicFormWithSize:function(c){c.prop("class")||c.addClass("form-control");var e=a(c,"aa-col")||d.defaultCol;b(c,'<div class="form-group col-'+e+'"></div>')}},this.defaultValMsgPlacementStrategy="below-field",this.valMsgPlacementStrategies={"below-field":function(a,b,d){var e=angular.element(c('<div aa-val-msg-for="{0}.{1}"></div>',b,d)),f=a[0].type;return f=f?f.toLowerCase():"text","radio"===f?a.parent().parent().append(e):a.parent().hasClass("input-group")?a.parent().after(e):a.after(e),e},hover:function(a,b,d,e){var f=angular.element(c('<div aa-val-msg-for="{0}.{1}" ng-show="showMessages && isHovered && errorMessages.length > 0"></div>',b,d));return a.on("mouseenter",function(){e.isHovered=!0,e.$apply()}),a.on("mouseleave",function(){e.isHovered=!1,e.$apply()}),a.after(f),f}},this.validIconStrategy={validIcon:'<i class="fa fa-check fa-lg"></i>',invalidIcon:'<i class="fa fa-exclamation-circle fa-lg"></i>',getContainer:function(a){var b=angular.element('<div class="col-xs-1 validation-icons"></div>');return a.parent().after(b),b}},this.defaultSpinnerClickStrategy="fontAwesomeInsideButton",this.spinnerClickStrategies={fontAwesomeInsideButton:function(a){var b=angular.element('<i style="margin-left: 5px;" class="fa fa-spinner fa-spin"></i>');return{before:function(){a.prop("disabled",!0),a.append(b)},after:function(){a.prop("disabled",!1),b.remove()}}}},this.defaultNotifyTarget="default",this.defaultOnNavigateAwayStrategy="confirmUiRouterAndDom",this.onNavigateAwayStrategies={confirmUiRouterAndDom:function(a,b){function c(a){return b.$aaFormExtensions.$changed?((a||window.event).returnValue=d,d):void 0}var d="You have unsaved changes are you sure you want to navigate away?";a.$on("$stateChangeStart",function(a){b.$aaFormExtensions.$changed&&(window.confirm(d)||a.preventDefault())}),angular.element(window).on("beforeunload",c),a.$on("$destroy",function(){angular.element(window).off("beforeunload",c)})},none:angular.noop},this.defaultFieldName="This field",this.validationMessages={required:"{0} is required.",email:"The field {0} must be an email.",minlength:"{0} must be at least {1} character(s).",maxlength:"{0} must be less than {1} characters.",min:"{0} must be at least {1}.",max:"{0} must be at most {1}.",pattern:"{0} is invalid.",url:"{0} must be a valid URL.",number:"{0} must be a number.",unknown:"{0} is invalid."},this.valMsgForTemplate='<div class="validation-errors"><div class="validation-error" ng-show="showMessages" ng-repeat="msg in errorMessages">{{msg}}</div><div class="notch notch-border"></div><div class="notch"></div></div>',this.confirmResetStrategy=function(){return window.confirm("Are you sure you want to reset any unsaved changes?")},this.ajaxValidationErrorMappingStrategy=function(a,b){400===a.status&&a.data.errors&&angular.forEach(a.data.errors,function(a){angular.forEach(b,function(b){var c=!0;angular.forEach(a.fieldNames,function(a){b[a]||(c=!1)}),c&&b.$aaFormExtensions.$addValidationError(a.errorMessage,a.fieldNames)})})},this.globalSettings={messageOnBlur:!0},this.$get=function(){return{defaultLabelStrategy:d.defaultLabelStrategy,labelStrategies:d.labelStrategies,defaultFieldGroupStrategy:d.defaultFieldGroupStrategy,fieldGroupStrategies:d.fieldGroupStrategies,validIconStrategy:d.validIconStrategy,validationMessages:d.validationMessages,defaultFieldName:d.defaultFieldName,valMsgForTemplate:d.valMsgForTemplate,valMsgPlacementStrategies:d.valMsgPlacementStrategies,defaultValMsgPlacementStrategy:d.defaultValMsgPlacementStrategy,defaultSpinnerClickStrategy:d.defaultSpinnerClickStrategy,spinnerClickStrategies:d.spinnerClickStrategies,defaultOnNavigateAwayStrategy:d.defaultOnNavigateAwayStrategy,onNavigateAwayStrategies:d.onNavigateAwayStrategies,defaultNotifyTarget:d.defaultNotifyTarget,confirmResetStrategy:d.confirmResetStrategy,ajaxValidationErrorMappingStrategy:d.ajaxValidationErrorMappingStrategy,availableForms:[],globalSettings:d.globalSettings}}})}(),function(){"use strict";angular.module("aa.formExtensions").factory("aaUtils",function(){return{guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})},toTitleCase:function(a){return a.replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})},splitCamelCase:function(a){return a.replace(/([a-z](?=[A-Z]))/g,"$1 ")},outerHTML:function(a){return a.outerHTML||function(a){var b,c=document.createElement("div");return c.appendChild(a.cloneNode(!0)),b=c.innerHTML,c=null,b}(a)},stringFormat:function(a){var b=Array.prototype.slice.call(arguments,1);return a.replace(/{(\d+)}/g,function(a,c){return"undefined"!=typeof b[c]?b[c]:a})},ensureaaFormExtensionsFieldExists:function(a,b){if(!a)throw new Error("Form was "+a);if(!b)throw new Error("Form was "+b);a.$aaFormExtensions[b]||(a.$aaFormExtensions[b]={showErrorReasons:[],$errorMessages:[],$element:null})},arrayRemove:function(a,b){if(a&&b){var c=a.indexOf(b);-1!==c&&a.splice(c,1)}},recursivePushChangeDependency:function(a,b){a.$aaFormExtensions.$changeDependencies.push(b),a.$aaFormExtensions.$parentForm&&this.recursivePushChangeDependency(a.$aaFormExtensions.$parentForm,b)},recursiveParentCheckAndSetFormChanged:function(a){this.checkAndSetFormChanged(a),a.$aaFormExtensions.$parentForm&&this.recursiveParentCheckAndSetFormChanged(a.$aaFormExtensions.$parentForm)},checkAndSetFormChanged:function(a){var b=!1;angular.forEach(a.$aaFormExtensions.$changeDependencies,function(a){a.isChanged&&(b=!0)}),a.$aaFormExtensions.$changed=b}}})}(),function(){"use strict";angular.module("aa.formExtensions").directive("aaField",["$compile","aaUtils",function(a,b){return{restrict:"A",scope:!1,replace:!0,priority:1e3,terminal:!0,compile:function(c,d){c.attr("ng-model",d.aaField);var e=d.aaField.substring(d.aaField.lastIndexOf(".")+1);return d.name||c.attr("name",e),d.type||"INPUT"!==c.prop("tagName").toUpperCase()||c.prop("type","text"),d.aaLabel||void 0!==d.noLabel||(e.lastIndexOf("Id")===e.length-2&&(e=e.substring(0,e.length-2)),c.attr("aa-label",b.toTitleCase(b.splitCamelCase(e)))),void 0===d.aaNoValMsg&&c.attr("aa-val-msg",""),c.removeAttr("aa-field"),c.replaceWith(b.outerHTML(c[0])),function(b,c){a(c)(b)}}}}])}(),function(){"use strict";angular.module("aa.formExtensions").directive("aaFieldGroup",["$compile","aaFormExtensions","$injector",function(a,b,c){return{restrict:"A",scope:!1,replace:!0,priority:1100,terminal:!0,compile:function(d,e){d.removeAttr("aa-field-group"),d.attr("aa-field",e.aaFieldGroup);var f=b.fieldGroupStrategies[e.aaFieldGroupStrategy||b.defaultFieldGroupStrategy];return f(d,c),function(b,c){a(c)(b)}}}}])}(),function(){"use strict";angular.module("aa.formExtensions").directive("aaLabel",["aaFormExtensions","aaUtils","$compile","$injector",function(a,b,c,d){return{compile:function(){return function(e,f,g){var h=a.labelStrategies[g.aaLabelStrategy];if(!h){var i=e.$eval(g.aaLabelStrategy);angular.isFunction(i)&&(h=i)}h||(h=a.labelStrategies[a.defaultLabelStrategy]);var j=void 0!==g.required;f[0].id||(f[0].id=b.guid());var k=h(f,g.aaLabel,j,d);k&&c(k)(e)}}}}])}(),function(){"use strict";angular.module("aa.formExtensions").directive("aaSpinnerClick",["$q","aaFormExtensions","$injector",function(a,b,c){return{link:function(d,e,f){var g=b.spinnerClickStrategies[f.spinnerClickStrategy||b.defaultSpinnerClickStrategy];if(!g)throw new Error("An inline or default spinner click strategy must be specified");e.on("click",function(){d.$apply(function(){var b=g(e,c);b.before(),a.when(d.$eval(f.aaSpinnerClick)).then(function(a){return b.after(),a})})})}}}])}(),function(){"use strict";angular.module("aa.formExtensions").directive("aaSubmitForm",["aaFormExtensions","$q","$injector",function(a,b,c){return{scope:{aaSubmitForm:"&"},restrict:"A",require:"^form",link:function(d,e,f,g){function h(){if(g.$aaFormExtensions.$onSubmitAttempt(),g.$valid){var h=a.spinnerClickStrategies[f.spinnerClickStrategy||a.defaultSpinnerClickStrategy],i=h(e,c);i.before(),b.when(d.aaSubmitForm())["finally"](function(a){return i.after(),a})}d.$apply()}e.on("click",h),"submit"===f.type&&(g.$aaFormExtensions.$onEnterKey=h)}}}])}(),function(){"use strict";angular.module("aa.formExtensions").directive("aaValMsg",["$compile","aaFormExtensions","$injector",function(a,b,c){return{require:["ngModel","^form"],link:function(d,e,f,g){var h=g[1];if(!f.name)throw new Error("In order to use aaValMsg a name MUST be specified on the element: "+e[0]);var i=d.$new(),j=b.valMsgPlacementStrategies[f.aaValMsg||b.defaultValMsgPlacementStrategy](e,h.$name,f.name,i,c);a(j)(i)}}}])}(),function(){"use strict";angular.module("aa.formExtensions").directive("aaValMsgFor",["aaFormExtensions","aaUtils","$timeout",function(a,b,c){return{require:["^form"],priority:1,scope:!0,link:function(a,d,e){c(function(){for(var c,d,f=e.aaValMsgFor,g=a,h=f.split("."),i=h.shift(),j="['"+h.join(".")+"']",k=i+j;(!c||!d)&&g;)c=g.$eval(k),d=g.$eval(i),c&&d||(g=g.$parent);b.ensureaaFormExtensionsFieldExists(d,c.$name),a.fieldInFormExtensions=g.$eval(i+".$aaFormExtensions"+j),a.$watchCollection(function(){return a.fieldInFormExtensions.$errorMessages},function(b){a.errorMessages=b}),a.$watch(function(){return[d.$aaFormExtensions.$invalidAttempt,a.fieldInFormExtensions.showErrorReasons]},function(b){var c=b[0],d=b[1];a.showMessages=c||d.length},!0)})},template:a.valMsgForTemplate,replace:!0}}])}(),function(){"use strict";angular.module("aa.formExtensions").directive("aaValidIcon",["aaFormExtensions",function(a){return{require:"ngModel",scope:!1,compile:function(b){var c=a.validIconStrategy.getContainer(b),d=angular.element(a.validIconStrategy.validIcon);c.append(d),d[0].style.display="none";var e=angular.element(a.validIconStrategy.invalidIcon);return c.append(e),e[0].style.display="none",function(a,b,c,f){f.$parsers.push(function(a){return f.$valid?(d[0].style.display="",e[0].style.display="none"):(d[0].style.display="none",e[0].style.display=""),a})}}}}])}(),function(){"use strict";angular.module("aa.formExtensions").directive("defaultOption",["aaFormExtensions","aaUtils","$compile","$injector",function(){return{priority:1,compile:function(){return{pre:function(a,b,c){if("SELECT"===b.prop("tagName").toUpperCase()&&void 0!==c.defaultOption){var d=c.defaultOption;(null===d||""===d)&&(d="Select",c.aaLabel&&(d+=" a "+c.aaLabel),d+="...");var e=b.children('option[value=""]');e.length||(b.append(angular.element('<option value=""></option>').html(d)),b.removeAttr("default-option"))}}}}}}])}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i){return{restrict:a?"EAC":"E",require:"form",compile:function(){return{pre:function(a,j,k,l){function m(a,b){a.$name=b}function n(a,b){a.$aaFormExtensions.$invalidAttempt=b,angular.forEach(a.$aaFormExtensions.$childForms,function(a){n(a,b)})}function o(b,c){f(function(){function d(){a.$watch(b,function(a,b){a!==b&&(g.isChanged=!angular.equals(g.initialValue,a),i.recursiveParentCheckAndSetFormChanged(l))},c)}if(void 0===c&&(c=!0),!angular.isString(b))throw new Error("$addChangeDependency only supports string watchExprs to allow for form reset support");var e=!1;if(angular.forEach(l.$aaFormExtensions.$changeDependencies,function(a){b===a.expr&&(e=!0)}),!e){var g={expr:b,isChanged:!1,initialValue:angular.copy(a.$eval(b)),$form:l};i.recursivePushChangeDependency(l,g);var j;f(function(){h.aaIsLoading?j=a.$watch(function(){return h.aaIsLoading},function(a){a||(j(),f(d))}):d()})}})}function p(c){function e(){angular.forEach(l.$aaFormExtensions.$changeDependencies,function(b){if(b.field&&b.field.$ngModel.$modelValue!==b.initialValue&&(b.field.$ngModel.$setViewValue(b.initialValue),b.field.$ngModel.$render()),b.expr){for(var c=a,e=null;void 0!==c.$eval(b.expr);)e=c,c=c.$parent;d(b.expr).assign(e,angular.copy(b.initialValue))}}),r(c)}return g.when(b.confirmResetStrategy()).then(function(a){return a&&e(),a})}function q(b){f(function(){angular.forEach(l.$aaFormExtensions.$changeDependencies,function(b){b.isChanged=!1,b.field&&(b.initialValue=b.field.$ngModel.$modelValue,i.checkAndSetFormChanged(b.field.$form)),b.expr&&(b.initialValue=angular.copy(a.$eval(b.expr)),i.checkAndSetFormChanged(b.$form))}),i.checkAndSetFormChanged(l),angular.isFunction(b)&&b()})}function r(d){f(function(){n(l,!1),angular.forEach(l.$aaFormExtensions.$allValidationErrors,function(a){a.field&&(a.field.showErrorReasons.length=0,a.field.$element.removeClass("aa-had-focus"),a.field.$ngModel.$setPristine())});var e=a.$eval(k.notifyTarget)||b.defaultNotifyTarget;angular.forEach(a.notifications,function(a){a&&a.template&&"aaNotifyTemplate-aaFormExtensionsValidationErrors"===a.template&&c.remove(a.messageHandle,e)}),angular.isFunction(d)&&d()})}function s(a,b){function c(a){if(angular.isObject(a))return a;var b=l.$aaFormExtensions[a];if(b||angular.forEach(l.$aaFormExtensions,function(c,d){d.toLowerCase()===a.toLowerCase()&&(b=c)}),!b)throw new Error("Could not find field '"+a+"' to add an error to");return b}if(!b){var d={message:a};return void l.$aaFormExtensions.$allValidationErrors.push(d)}if(angular.isArray(b)){var e=[],g=a.replace(/[^a-z0-9]/gi,"-");angular.forEach(b,function(a){e.push(c(a))});var h=function(a){var b=function(){a.$setValidity(g,!0),f(function(){angular.forEach(e,function(a){i.arrayRemove(a.$ngModel.$viewChangeListeners,b)})})};return b};angular.forEach(e,function(b){b.$addError(a,g,!0),b.$ngModel.$viewChangeListeners.unshift(h(b.$ngModel))})}else c(b).$addError(a)}var t;if(void 0===k.isolatedForm)t=j.parent().controller("form");else{l.$$parentForm.$removeControl(l);var u={$addControl:angular.noop,$$renameControl:m,$removeControl:angular.noop,$setValidity:angular.noop,$setDirty:angular.noop,$setPristine:angular.noop,$setSubmitted:angular.noop},v=j.parent().controller("form"),w=l.$setValidity;l.$$parentForm=u,l.$setValidity=function(a,b,c){w(a,b,c),v.$setValidity(a,!0,l)}}if(l.$aaFormExtensions={$onSubmitAttempt:function(){n(l,l.$invalid)},$parentForm:t,$childForms:[],$allValidationErrors:[],$changeDependencies:[],$changed:!1,$invalidAttempt:!1,$addChangeDependency:o,$reset:p,$resetChanged:q,$clearErrors:r,$addValidationError:s},t&&t.$aaFormExtensions.$childForms.push(l),!t&&"false"!==k.aaConfirmationMessage){var x=b.onNavigateAwayStrategies[k.onNavigateAwayStrategy||b.defaultOnNavigateAwayStrategy];angular.isFunction(x)&&x(a,l,e)}a.$watchCollection(function(){return a.$$aaFormExtensionsTodos},function(b){if(b)for(var c=a.$$aaFormExtensionsTodos.length-1;c>=0;c--){var d=a.$$aaFormExtensionsTodos[c];(d.targetFormName===l.$name||!d.targetFormName&&!l.$aaFormExtensions.$parentForm)&&(l.$aaFormExtensions[d.type].apply(this,d.args),a.$$aaFormExtensionsTodos.splice(c,1))}}),a.$on("$destroy",function(){function a(c){c.$aaFormExtensions.$allValidationErrors.length&&(angular.forEach(b,function(a){for(var b,d=c.$aaFormExtensions.$allValidationErrors.length;d--;)b=c.$aaFormExtensions.$allValidationErrors[d],b.field&&b.field.$ngModel!==a||c.$aaFormExtensions.$allValidationErrors.splice(d,1)}),i.arrayRemove(c.$aaFormExtensions.$childForms,l),angular.forEach(l.$aaFormExtensions.$changeDependencies,function(a){i.arrayRemove(c.$aaFormExtensions.$changeDependencies,a),i.checkAndSetFormChanged(c)}),c.$aaFormExtensions.$parentForm&&a(c.$aaFormExtensions.$parentForm))}var b=[];l.$aaFormExtensions.$parentForm&&(angular.forEach(l,function(a,c){0!==c.indexOf("$")&&b.push(a)}),a(l.$aaFormExtensions.$parentForm))})},post:function(a,d,e,f){function g(){if(f.$aaFormExtensions.$invalidAttempt)return f.$aaFormExtensions.$allValidationErrors;var a=[];return angular.forEach(f.$aaFormExtensions.$allValidationErrors,function(b){(!b.field||b.field.showErrorReasons.length)&&a.push(b)}),a}b.availableForms.push(f),d.on("keyup",function(a){13===a.keyCode&&angular.isFunction(f.$aaFormExtensions.$onEnterKey)&&"TEXTAREA"!==a.target.tagName.toUpperCase()&&f.$aaFormExtensions.$onEnterKey()});var h=null,j=a.$eval(e.notifyTarget),k=j||b.defaultNotifyTarget;!k||f.$aaFormExtensions.$parentForm&&!j||a.$watchCollection(function(){var a=[];return angular.forEach(f.$aaFormExtensions.$allValidationErrors,function(b){a.push(b)}),a.push(f.$aaFormExtensions.$invalidAttempt),a},function(){var a=f.$aaFormExtensions.$invalidAttempt&&f.$invalid;a||angular.forEach(f.$aaFormExtensions.$allValidationErrors,function(b){(!b.field||b.field.showErrorReasons.length)&&(a=!0)}),h&&!a&&(c.remove(h,k),h=null),!h&&a&&(h=c.add({validationErrorsToDisplay:g,onClose:function(){h=null}},k,"aaFormExtensionsValidationErrors"))}),a.$on("$destroy",function(){h&&c.remove(h,k),i.arrayRemove(b.availableForms,f)})}}}}}angular.module("aa.formExtensions").directive("ngForm",["aaFormExtensions","aaNotify","$parse","$injector","$timeout","$q","aaLoadingWatcher","aaUtils",function(b,c,d,e,f,g,h,i){return a(!0,b,c,d,e,f,g,h,i)}]).directive("form",["aaFormExtensions","aaNotify","$parse","$injector","$timeout","$q","aaLoadingWatcher","aaUtils",function(b,c,d,e,f,g,h,i){return a(!1,b,c,d,e,f,g,h,i)}])}(),function(){"use strict";angular.module("aa.formExtensions").directive("ngModel",["aaFormExtensions","$document","aaLoadingWatcher","$timeout","aaUtils",function(a,b,c,d,e){return{require:["ngModel","?^form"],priority:1,link:function(f,g,h,i){function j(){function a(){s.initialValue!==s.initialValue&&(s.initialValue=n.$modelValue);var a=s.initialValue!==n.$modelValue;s.isChanged!==a&&(s.isChanged=a,e.recursiveParentCheckAndSetFormChanged(o))}s.initialValue=n.$modelValue,n.$viewChangeListeners.push(a),n.$formatters.push(function(b){return a(),b})}function k(){var b,c=q.$errorMessages;c.length=0;for(var d in n.$error)if(n.$error[d]){if(h[d+"Msg"])b=e.stringFormat(h[d+"Msg"],p,h[d]);else if("minlength"===d)b=e.stringFormat(h.ngMinlengthMsg||a.validationMessages.minlength,p,h.ngMinlength);else if("maxlength"===d)b=e.stringFormat(h.ngMaxlengthMsg||a.validationMessages.maxlength,p,h.ngMaxlength);else if("min"===d)b=e.stringFormat(h.minMsg||a.validationMessages.min,p,h.min);else if("max"===d)b=e.stringFormat(h.maxMsg||a.validationMessages.max,p,h.max);else if("pattern"===d)b=e.stringFormat(h.ngPatternMsg||a.validationMessages.pattern,p);else{if("required"===d&&"number"===g[0].type&&n.$error.number)continue;b=a.validationMessages[d]?e.stringFormat(a.validationMessages[d],p):t[d]?t[d]:e.stringFormat(a.validationMessages.unknown,p)}c.push(b)}l(o,c)}function l(a,b){for(var c=a.$aaFormExtensions.$allValidationErrors.length-1;c>=0;c--)a.$aaFormExtensions.$allValidationErrors[c].field===q&&a.$aaFormExtensions.$allValidationErrors.splice(c,1);b&&angular.forEach(b,function(b){a.$aaFormExtensions.$allValidationErrors.push({field:q,message:b})}),a.$aaFormExtensions.$parentForm&&l(a.$aaFormExtensions.$parentForm,b)}function m(a,b,c){if(b||(b=a.replace(/[^a-z0-9]/gi,"-")),n.$setValidity(b,!1),t[b]=a,q.showErrorReasons.push(b),q.$calcErrorMessages(),g.addClass("explicit-add-error"),!c){var f=function(){n.$setValidity(b,!0),d(function(){delete t[b],e.arrayRemove(n.$viewChangeListeners,f),g.removeClass("explicit-add-error")})};n.$viewChangeListeners.unshift(f)}}var n=i[0],o=i[1],p=a.defaultFieldName;if(o&&n.$name){e.ensureaaFormExtensionsFieldExists(o,n.$name);var q=o.$aaFormExtensions[n.$name];if(q.$form=o,q.$element=g,q.$ngModel=n,q.$calcErrorMessages=k,q.$addError=m,h.aaLabel||h.aaFieldName?p=h.aaLabel||h.aaFieldName:g[0].id&&angular.forEach(b.find("label"),function(a){
a.getAttribute("for")===g[0].id&&(p=(a.innerHTML||"").replace("*","").trim())}),g.on("blur",function(){q.showErrorReasons.push("hadFocus"),g.addClass("aa-had-focus"),d(function(){},1)}),f.$watch(function(){return o.$aaFormExtensions.$invalidAttempt},function(a){a&&g.addClass("aa-invalid-attempt")}),void 0===h.aaExcludeChanges){var r,s={field:q,isChanged:!1};e.recursivePushChangeDependency(o,s),d(function(){c.isLoading?r=f.$watch(function(){return c.isLoading},function(a){a||(r(),d(j))}):j()}),f.$on("$destroy",function(){function a(b){b.$aaFormExtensions.$parentForm&&a(b.$aaFormExtensions.$parentForm),e.arrayRemove(b.$aaFormExtensions.$changeDependencies,s),e.checkAndSetFormChanged(b)}delete o.$aaFormExtensions[n.$name],l(o),a(o)})}var t={};f.$watch(function(){return n.$error},function(a){a&&q.$calcErrorMessages()},!0)}}}}])}();