/*! angular-agility 13-02-2014 */
!function(){function a(b){return b?(b^16*Math.random()>>b/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,a)}function b(a){return a.replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})}function c(a){return a.replace(/([a-z](?=[A-Z]))/g,"$1 ")}function d(a){return a.outerHTML||function(a){var b,c=document.createElement("div");return c.appendChild(a.cloneNode(!0)),b=c.innerHTML,c=null,b}(a)}function e(a){var b=Array.prototype.slice.call(arguments,1);return a.replace(/{(\d+)}/g,function(a,c){return"undefined"!=typeof b[c]?b[c]:a})}function f(a){function b(a,c){a.$aaFormExtensions.$invalidAttempt=c,angular.forEach(a,function(d,e){0!==e.indexOf("$")&&a.constructor===d.constructor&&b(d,c)})}a.$aaFormExtensions||(a.$aaFormExtensions={$submitAttempt:function(){b(a,a.$invalid)}})}function g(a,b){f(a),a.$aaFormExtensions[b]||(a.$aaFormExtensions[b]={$hadFocus:!1,$errorMessages:[],$element:null})}angular.module("aa.formExtensions",[]).directive("aaSaveForm",function(){return{link:function(){throw"aaSaveForm has been deprecated in favor of a more sensically named aaSubmitForm"}}}).directive("aaSubmitForm",["aaFormExtensions",function(a){return{scope:{onInvalidAttempt:"&",aaSubmitForm:"&"},restrict:"A",require:"^form",link:function(b,c,d,e){f(e),c.on("click",function(){b.$apply(function(){if(e.$aaFormExtensions.$submitAttempt(),e.$valid)b.aaSubmitForm();else{var c="function"==typeof b.onInvalidAttempt(),d="function"==typeof a.defaultOnInvalidAttempt;if(c||d){var f=[];if(angular.forEach(e.$aaFormExtensions,function(a,b){0!==b.indexOf("$")&&(f=f.concat(a.$errorMessages))}),c)return void b.onInvalidAttempt(f,e);a.defaultOnInvalidAttempt(f,e)}}})})}}}]).directive("ngModel",["aaFormExtensions","$document","$timeout",function(a,b,c){return{require:["ngModel","?^form"],priority:1,link:function(d,f,h,i){function j(b){var c=l.$aaFormExtensions[k.$name].$errorMessages;c.length=0;for(var d in k.$error)k.$error[d]&&("minlength"===d?c.push(e(a.validationMessages[d],m,h.ngMinlength)):"maxlength"===d?c.push(e(a.validationMessages[d],m,h.ngMaxlength)):"min"===d?c.push(e(a.validationMessages[d],m,h.min)):"max"===d?c.push(e(a.validationMessages[d],m,h.max)):"required"===d&&"number"===f[0].type?c.push(e(a.validationMessages.number,m)):a.validationMessages[d]&&c.push(e(a.validationMessages[d],m)));return b}var k=i[0],l=i[1],m="This field";l&&(h.aaLabel?m=h.aaLabel:f[0].id&&angular.forEach(b.find("label"),function(a){a.getAttribute("for")===f[0].id&&(m=(a.innerHTML||"").replace("*","").trim())}),g(l,k.$name),l.$aaFormExtensions[k.$name].$element=f,f.on("blur",function(){d.$apply(function(){l.$aaFormExtensions[k.$name].$hadFocus=!0,f.addClass("aa-had-focus")})}),d.$watch(function(){return l.$aaFormExtensions.$invalidAttempt},function(a){a&&f.addClass("aa-invalid-attempt")}),c(j,0),k.$parsers.push(j))}}}]).directive("aaValMsg",["$compile","aaFormExtensions",function(a,b){return{require:["ngModel","^form"],link:function(c,d,e,f){var g=(f[0],f[1]),h=b.valMsgPlacementStrategies[e.aaValMsg||b.defaultValMsgPlacementStrategy](d,g.$name,e.name);a(h)(c)}}}]).directive("aaValMsgFor",["aaFormExtensions",function(a){return{require:["^form"],priority:1,scope:!0,link:function(a,b,c){var d=c.aaValMsgFor,e=a.$eval(d),f=a.$eval(d.substring(0,d.indexOf(".")));g(f,e.$name);var h=a.$eval(d.replace(".",".$aaFormExtensions."));a.$watchCollection(function(){return h.$errorMessages},function(b){a.errorMessages=b}),a.$watchCollection(function(){return[f.$aaFormExtensions.$invalidAttempt,h.$hadFocus]},function(b){var c=b[0],d=b[1];a.showMessages=c||d})},template:a.valMsgForTemplate,replace:!0}}]).directive("aaLabel",["aaFormExtensions",function(b){return{link:function(c,d,e){var f=e.aaLabelStrategy||b.defaultLabelStrategy,g=void 0!==e.required;d[0].id||(d[0].id=a()),b.labelStrategies[f](d,e.aaLabel,g)}}}]).directive("aaAutoField",["$compile",function(a){return{restrict:"A",scope:!1,replace:!0,priority:1e3,terminal:!0,compile:function(e,f){e.attr("ng-model",f.aaAutoField);var g=f.aaAutoField.substring(f.aaAutoField.lastIndexOf(".")+1);return f.name||e.attr("name",g),f.aaLabel||void 0!==f.noLabel||e.attr("aa-label",b(c(g))),e.attr("aa-val-msg",""),e.removeAttr("aa-auto-field"),e.replaceWith(d(e[0])),function(b,c){a(c)(b)}}}}]).directive("aaValidIcon",["aaFormExtensions",function(a){return{require:"ngModel",scope:!1,compile:function(b){var c=a.validIconStrategy.getContainer(b),d=angular.element(a.validIconStrategy.validIcon);c.append(d),d[0].style.display="none";var e=angular.element(a.validIconStrategy.invalidIcon);return c.append(e),e[0].style.display="none",function(a,b,c,f){f.$parsers.push(function(a){return f.$valid?(d[0].style.display="",e[0].style.display="none"):(d[0].style.display="none",e[0].style.display=""),a})}}}}]).provider("aaFormExtensions",function(){var a=this;this.defaultLabelStrategy="default",this.setDefaultLabelStrategy=function(a){this.defaultLabelStrategy=a},this.labelStrategies={bootstrap3InlineForm:function(a,b,c){var d=angular.element("<label>").attr("for",a[0].id).addClass("col-sm-2 control-label").html(b+(c?" *":"")),e=["button","submit"];if(-1!==e.indexOf(a[0].type))throw"Generating a label for and input type "+a[0].type+" is unsupported.";a.parent().parent().prepend(d)},"default":function(a,b,c){a[0].parentNode.insertBefore(angular.element("<label>").attr("for",a[0].id).html(b+(c?" *":""))[0],a[0])}},this.registerLabelStrategy=function(a,b){this.labelStrategies[a]=b},this.defaultValMsgPlacementStrategy="default",this.setDefaultValMsgPlacementStrategy=function(a){this.defaultValMsgPlacementStrategy=a},this.valMsgPlacementStrategies={"default":function(a,b,c){var d=angular.element(e('<div aa-val-msg-for="{0}.{1}"></div>',b,c)),f=a[0].type.toLowerCase();return"radio"===f?a.parent().parent().append(d):a.after(d),d}},this.registerValMsgPlacementStrategy=function(a,b){this.valMsgPlacementStrategies[a]=b},this.validIconStrategy={validIcon:'<i class="fa fa-check fa-lg"></i>',invalidIcon:'<i class="fa fa-exclamation-circle fa-lg"></i>',getContainer:function(a){var b=angular.element('<div class="col-xs-1 validation-icons"></span>');return a.parent().after(b),b}},this.setValidIconStrategy=function(b){a.validIconStrategy=b},this.validationMessages={required:"{0} is required.",email:"The field {0} must be an email.",minlength:"{0} must be at least {1} character(s).",maxlength:"{0} must be less than {1} characters.",min:"{0} must be at least {1}.",max:"{0} must be at most {1}.",pattern:"{0} is invalid.",url:"{0} must be a valid URL.",number:"{0} must be number."},this.setValidationMessage=function(b,c){a.validationMessages[b]=c},this.setValidationMessages=function(b){a.validationMessages=b},this.valMsgForTemplate='<div class="validation-error" ng-show="showMessages" ng-repeat="msg in errorMessages">{{msg}}</div>',this.setValMsgForTemplate=function(a){this.valMsgForTemplate=a},this.defaultOnInvalidAttempt=function(){},this.setDefaultOnInvalidAttempt=function(a){this.defaultOnInvalidAttempt=a},this.$get=function(){return{defaultLabelStrategy:a.defaultLabelStrategy,labelStrategies:a.labelStrategies,validIconStrategy:a.validIconStrategy,validationMessages:a.validationMessages,valMsgForTemplate:a.valMsgForTemplate,valMsgPlacementStrategies:a.valMsgPlacementStrategies,defaultValMsgPlacementStrategy:a.defaultValMsgPlacementStrategy,defaultOnInvalidAttempt:a.defaultOnInvalidAttempt}}})}(),angular.module("aa.select2",[]).directive("aaSelect2",function(){return{require:"ngModel",template:'<input type="hidden" />',replace:!0,link:function(a,b,c,d){var e=a.$eval(c.aaSelect2)||{},f={},g=e.$settings,h=g?angular.isFunction(g.options):!1,i=g?angular.isArray(g.options):!1,j=g&&g.mode?-1!=g.mode.indexOf("id"):!1,k=g&&g.mode?-1!=g.mode.indexOf("object"):!1,l=g&&g.mode?-1!=g.mode.indexOf("tags"):!1,m=g&&"@this"===g.id&&"@this"===g.text;delete e.$settings;var n=a.$eval(c.ngModel);g&&(m&&(g.id="id",g.text="text"),k&&(g.id=g.id||"id",g.text=g.text||"text"),g.ajaxMap=f.ajaxMap||function(a){return a},i&&(f.data=f.data||{},f.data.text=g.text,f.data.results=g.options),h&&(f.query=function(a){g.options(a.term).success(function(b){if(m){var c=[];angular.forEach(b,function(a){c.push({id:a,text:a})}),b=c}a.callback({results:b,text:g.text})})},n&&j&&(f.initSelection=function(a,b){return m?void b({id:n,text:n}):void g.textLookup(n).success(function(a){b(a)})})),g.id&&(f.id=g.id),g.text&&(f.formatSelection=function(a){return a[g.text]},f.formatResult=function(a){return a[g.text]}),l&&(f.tags=n||[]));var o={width:"resolve"},p=angular.extend(o,f,e);b.select2(p),d.$render=function(){return d.$modelValue?void(j?b.select2("val",d.$modelValue):k&&b.select2("data",d.$modelValue)):void b.select2("val","")},b.bind("change",function(){a.$apply(function(){var a=b.select2("val");if(""===a)return void d.$setViewValue(null);if(j)d.$setViewValue(a);else if(k){var c=b.select2("data");d.$setViewValue(c)}})}),b.bind("$destroy",function(){b.select2("destroy")})}}});